#local platform = require 'bee.platform'

<default>
rootdir = lua

#if platform.OS == 'Windows' then
    [lua54]
        target = shared_library
        source = *.c
        source = !lua.c
        source = !luac.c
        define = LUA_BUILD_AS_DLL
    [lua]
        target = executable
        deps   = lua54
        source = lua.c
#else
    [lua]
        target = executable
        source = *.c
        source = !luac.c
        #if platform.OS == 'macOS' then
            ldflag = -Wl,-E
            define = LUA_USE_LINUX
        #else
            define = LUA_USE_MACOSX
        #end
        link = m
        link = dl
#end

<default>
rootdir = lpeglabel

[lpeglabel : lua_library]
target = lua_library
source = *.c
